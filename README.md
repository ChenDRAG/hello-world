# 疫情反击战 游戏策划

<center> 计76 徐天行</center>
[TOC]

## 游戏介绍

游戏基于疫情泄露后医疗公司着手进行疫情治理的背景开发，目标是以最低的成本对满足疫区的治理需求。玩家需要合理摆放检测设备，检测出地图中隐藏的疫情信息，并购买地皮建造医疗设备，控制尽可能多的疫区。每控制一个疫区会得到一定的得分，控制的疫区越多，得分越高。

## 游戏地图

游戏在一个MapWidth*MapHeight的地图上进行。初始时，地图上存在若干高大建筑物，高大建筑物会阻碍检测设备的检测范围与安置，治理设备的治理范围与安置，存在高大建筑物的地皮价格为0，其他土地价格均为LandPrice。地图上还存在若干疫区，注意春节期间高大建筑物不为人员聚集场所，与疫区不重合，建筑物与建筑物，疫区与疫区也不重合。一张合法的地图布局例子如下

![image-20200119155709306](../../AppData/Roaming/Typora/typora-user-images/image-20200119155709306.png)

其中蓝色表示高大建筑物，红色表示疫区，初始时1/3的疫区为玩家1所知晓，另1/3疫区为玩家2所知晓，剩下1/3疫区由于未爆发大量病例，双方均不知晓病毒的情况，不知晓的疫区在检测前隐藏不可见，不可被治理，已知晓的疫区信息包括疫区的位置，疫区的病毒，治理后的收益。

若如下图中黄色表示公开疫区，红色表示隐藏疫区，橙色表示已检测到的隐藏疫区

![image-20200120100051234](../../AppData/Roaming/Typora/typora-user-images/image-20200120100051234.png)

对于AI来说可见地图为

![image-20200120100150702](../../AppData/Roaming/Typora/typora-user-images/image-20200120100150702.png)

游戏开始后，地图上可以摆放检测设备与治理设备，因此地图上有效的元素共有四种：疫区，建筑物，治理设备，检测设备，它们之间的在地图中的是否可重合关系如下

| 物体     | 疫区 | 建筑物 | 检测设备 | 治理设备 |
| -------- | ---- | ------ | -------- | -------- |
| 疫区     | ×    | ×      | √        | √        |
| 建筑物   | ×    | ×      | ×        | ×        |
| 检测设备 | √    | ×      | ×        | √        |
| 治理设备 | √    | ×      | √        | ×        |

## 疫区

每个疫区可能存在多种病毒，若共有K=3种病毒，那么总共有2^K^-1种疫区可能出现，由于感染人群的不同，在不经过检测设备覆盖的情况下无法判断疫区分布并治理疫区，疫区的治理流程如下：

1. 疫区如果在检测设备的检测范围内，将被探查到疫区的具体位置与病毒的种类
2. 被检测到的隐藏疫区或公开的疫区如果在治理设备的治理范围内，相应病毒将会被消灭
3. 某疫区所有传染病病毒都被某家医药公司消灭后，该疫区被彻底治理，向该医药公司返回收益，返回积分，注意不存在合作治理疫区的情况
4. 每个疫区的收益和得分与病毒分布和地价有关，若病毒为x~1~, ... x~p~ ，则收益为Profit~x1~ + ... + Profit~xp~ + LandPrice 得分为Profit~x1~ + ... + Profit~xp~ + LandPrice

## 高大建筑物

高大建筑物不仅会影响检测设备和治理设备的放置，还会影响检测设备和治理设备的影响范围，影响的方式见检测设备/治理设备的作用范围

## 检测设备

检测设备是一种设定为飞行物一样的物体，不同种检测设备可以提供不同的检测范围，检测设备的价格仅与检测设备的种类相关。检测设备可以检测出检测范围内所有的疫区的位置和它们区域内所有的病毒组成，对于隐藏疫区来说一定要先检测才能处理

以下是三种可能使用的检测设备，它们的检测范围分别如下，每种检测设备覆盖格子仅为图中所示，不存在延申

![image-20200119165105106](../../AppData/Roaming/Typora/typora-user-images/image-20200119165105106.png)



![image-20200119165322182](../../AppData/Roaming/Typora/typora-user-images/image-20200119165322182.png)

![image-20200119165400663](../../AppData/Roaming/Typora/typora-user-images/image-20200119165400663.png)

橙色区域为检测设备所在位置，橙色和黄色区域为检测范围

高大建筑物，对检测范围的影响如下

![image-20200119165727090](../../AppData/Roaming/Typora/typora-user-images/image-20200119165727090.png)

![image-20200119165837465](../../AppData/Roaming/Typora/typora-user-images/image-20200119165837465.png)

![image-20200119165634062](../../AppData/Roaming/Typora/typora-user-images/image-20200119165634062.png)

## 治理设备

治理设备是一种设定为工厂一样的建筑，治理设备只能建造在自己购买的地皮上，治理设备的治理范围与检测设备的检测范围相同，有3种选择。一台治理设备只能解决一种病毒，因此如果有K种病毒，那么至少有K种治理设备（不考虑治理范围的情况下）。

消灭病毒 x ，治理范围的种类为 r 的设备的建造费用为：RangeCost~r~ + ConstructionCost~x~

## 特殊技能

超级侦察机：请军队提供疫区检测的帮助

- 指定某个位置，返回距离该位置曼哈顿距离最小的尚未被检测的一处疫区的情报
- 如果均已被发现，返回空
- 超级侦察机的使用不受高大建筑物影响

## 地皮竞拍

地皮的购买需要经过竞拍，当一名玩家对某块地皮感兴趣，可以给出自己的出价，该价格必须为LandPrice*(1+0.1\*n)(n为自然数)，如果该地皮在之前的回合由对方给出历史最高出价，那么新给出的地皮竞价一定要更高。当某地皮连续6回合历史最高出价不改变，判断出价方是否有足够的金钱购买该地皮，如果有钱则地皮竞拍成功，成交价格为该历史最高价格；如果金钱不够，则流拍，该出价方不允许再对该地皮出价，对方可以以地皮最低成交价格LandPrice购买该地皮

## 游戏流程

游戏流程图如下

- 游戏开始阶段，向两方发送地图信息，高大建筑物的分布情况
- 双方轮流进行回合
    - 回合开始，向当前回合行动玩家发送当前局面信息，包括己方已知的疫区，钱数，自己拥有的地皮，土地拍卖情况等等
    - 玩家进行决策，每回合可以同时进行以下三种操作各一次
        - 在某个合法位置设置一台检测设备
        - 请军队派出超级侦察机
        - 给出对某合法位置的地皮的合法出价
        - 在自己持有的地皮位置建造治理设备
    - 作出决策后，判定顺序如下，交换
        1. 治理设备的建造
        2. 结算操作中地皮的出价
        3. 设置新的检测设备
        4. 超级侦察机技能结算
        5. 所有地皮竞拍的回合数+1，更新地皮的状态
        6. 判断游戏结束，结束则退出



